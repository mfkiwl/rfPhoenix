F00:0001       # Fibonacci calculator Thor2021 asm
F00:0002       # r1 in the end will hold the Nth fibonacci number
F00:0003       
F00:0004       	.bss
F00:0005       _bss_a:
F00:0006       	.space	10
F00:0007       
F00:0008       	.data
F00:0009       _data_a:
F00:0010       	.space	10
F00:0011       
F00:0012       #	.org	0xFFFFFFFFFFFE0000
F00:0013       	.text
F00:0014       	.align	1
F00:0015       start:
F00:0016       	AND		r0,r0,0				# set r0 to zero
               S03:00000000:  08 00 00 00 00
F00:0017       	CSRRD	r2,r0,0x3001	# get the thread number
               S03:00000005:  87 00 80 00 18
F00:0018       	AND	r2,r2,3					# 0 to 3
               S03:0000000A:  88 40 80 01 00
F00:0019       	BNE	r2,r0,stall			# Allow only thread 0 to work
               S03:0000000F:  9C 00 70 30 00
F00:0020       
F00:0021       	LDI	r2,0xFD
               S03:00000014:  89 00 80 7E 00
F00:0022       	LDI	r2,0x01		# x = 1
               S03:00000019:  89 00 80 00 00
F00:0023       	STT	r2,0xFFFC0000
               S03:0000001E:  BA 00 00 00 00 01 FC FF
F00:0024       
F00:0025       	LDI	r3,0x10		# calculates 16th fibonacci number (13 = D in hex) (CHANGE HERE IF YOU WANT TO CALCULATE ANOTHER NUMBER)
               S03:00000026:  C9 00 00 08 00
F00:0026       	OR	r1,r3,r0	# transfer y register to accumulator
               S03:0000002B:  42 60 00 40 02
F00:0027       	ADD	r3,r3,-3	# handles the algorithm iteration counting
               S03:00000030:  C4 60 80 FE 7F
F00:0028       
F00:0029       	LDI	r1,2		# a = 2
               S03:00000035:  49 00 00 01 00
F00:0030       	STT	r1,0xFFFC0004		# stores a
               S03:0000003A:  7A 00 00 02 00 01 FC FF
F00:0031       
F00:0032       floop: 
F00:0033       	LDT	r2,0xFFFC0004		# x = a
               S03:00000042:  B4 00 00 02 00 01 FC FF
F00:0034       	ADD	r1,r1,r2	# a += x
               S03:0000004A:  42 20 00 01 01
F00:0035       	STT	r1,0xFFFC0004		# stores a
               S03:0000004F:  7A 00 00 02 00 01 FC FF
F00:0036       	STT	r2,0xFFFC0000		# stores x
               S03:00000057:  BA 00 00 00 00 01 FC FF
F00:0037       	ADD	r3,r3,-1	# y -= 1
               S03:0000005F:  C4 60 80 FF 7F
F00:0038         BNE r3,r0,floop	# jumps back to loop if Z bit != 0 (y's decremention isn't zero yet)
               S03:00000064:  DC 00 70 EF FF
F00:0039         NOP
               S03:00000069:  0B
F00:0040         NOP
               S03:0000006A:  0B
F00:0041         NOP
               S03:0000006B:  0B
F00:0042         NOP
               S03:0000006C:  0B
F00:0043         NOP
               S03:0000006D:  0B
F00:0044       	NOP  
               S03:0000006E:  0B
F00:0045       stall:
F00:0046       	BRA	stall
               S03:0000006F:  19 00 00 00 00
F00:0047       


Sections:
S01  .bss
S02  .data
S03  .text


Sources:
F00  fibonacci.asm


Symbols:
floop LAB (0x42) sec=.text 
stall LAB (0x6f) sec=.text 
start LAB (0x0) UNUSED sec=.text 
_data_a LAB (0x0) UNUSED sec=.data 
_bss_a LAB (0x0) UNUSED sec=.bss 
__VASM EXPR(0=0x0) INTERNAL 
__MSDOSFS EXPR(0=0x0) INTERNAL 

There have been no errors.
